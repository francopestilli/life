<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
                "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<head>
  <title>Description of feClipFibersToVolume</title>
  <meta name="keywords" content="feClipFibersToVolume">
  <meta name="description" content="Clip fibers to be constrained within a Volume.">
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
  <meta name="generator" content="m2html v1.5 &copy; 2003-2005 Guillaume Flandin">
  <meta name="robots" content="index, follow">
  <link type="text/css" rel="stylesheet" href="../m2html.css">
</head>
<body>
<a name="_top"></a>
<div><a href="../index.html">Home</a> &gt;  <a href="index.html">utility</a> &gt; feClipFibersToVolume.m</div>

<!--<table width="100%"><tr><td align="left"><a href="../index.html"><img alt="<" border="0" src="../left.png">&nbsp;Master index</a></td>
<td align="right"><a href="index.html">Index for utility&nbsp;<img alt=">" border="0" src="../right.png"></a></td></tr></table>-->

<h1>feClipFibersToVolume
</h1>

<h2><a name="_name"></a>PURPOSE <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<div class="box"><strong>Clip fibers to be constrained within a Volume.</strong></div>

<h2><a name="_synopsis"></a>SYNOPSIS <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<div class="box"><strong>function [fg, kept] = feClipFibersToVolume(fg,coords,maxVolDist) </strong></div>

<h2><a name="_description"></a>DESCRIPTION <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<div class="fragment"><pre class="comment"> Clip fibers to be constrained within a Volume.

  function fibers = feClipFibersToVolume(fibers,coords,maxVolDist)

 INPUTS:
        fibers         - A cell array of fibers, each defined as a 3xN array
                         of x,y,z coordinates. E.g., fg.fibers.
        coords         - A volume of defined as a 3xN array of x,y,z coordinates.
        maxVolDist     - The farther distance (in mm) from the volume a node can
                         be to be kept in the fiber.
        
 OUTPUTS:
        fibersOut      - A cell-array of fibers clipped within the volume 
                        defined by coords.
        kept           - fibers that were kept out of the original fiber
                         group. Because fibers left with no nodes in coords
                         are deleted the numbe rof kept fibes can be less
                         then the original number of fibers,

 SEE ALSO: <a href="feClipFiberNodes.html" class="code" title="function nodesToKeep = feClipFiberNodes(fiber,coords, maxVolDistance)">feClipFiberNodes</a>.m, feConnectomePreprocess.m


 Copyright (2013-2014), Franco Pestilli, Stanford University, pestillifranco@gmail.com.</pre></div>

<!-- crossreference -->
<h2><a name="_cross"></a>CROSS-REFERENCE INFORMATION <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
This function calls:
<ul style="list-style-image:url(../matlabicon.gif)">
</ul>
This function is called by:
<ul style="list-style-image:url(../matlabicon.gif)">
</ul>
<!-- crossreference -->



<h2><a name="_source"></a>SOURCE CODE <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<div class="fragment"><pre>0001 <a name="_sub0" href="#_subfunctions" class="code">function [fg, kept] = feClipFibersToVolume(fg,coords,maxVolDist)</a>
0002 <span class="comment">% Clip fibers to be constrained within a Volume.</span>
0003 <span class="comment">%</span>
0004 <span class="comment">%  function fibers = feClipFibersToVolume(fibers,coords,maxVolDist)</span>
0005 <span class="comment">%</span>
0006 <span class="comment">% INPUTS:</span>
0007 <span class="comment">%        fibers         - A cell array of fibers, each defined as a 3xN array</span>
0008 <span class="comment">%                         of x,y,z coordinates. E.g., fg.fibers.</span>
0009 <span class="comment">%        coords         - A volume of defined as a 3xN array of x,y,z coordinates.</span>
0010 <span class="comment">%        maxVolDist     - The farther distance (in mm) from the volume a node can</span>
0011 <span class="comment">%                         be to be kept in the fiber.</span>
0012 <span class="comment">%</span>
0013 <span class="comment">% OUTPUTS:</span>
0014 <span class="comment">%        fibersOut      - A cell-array of fibers clipped within the volume</span>
0015 <span class="comment">%                        defined by coords.</span>
0016 <span class="comment">%        kept           - fibers that were kept out of the original fiber</span>
0017 <span class="comment">%                         group. Because fibers left with no nodes in coords</span>
0018 <span class="comment">%                         are deleted the numbe rof kept fibes can be less</span>
0019 <span class="comment">%                         then the original number of fibers,</span>
0020 <span class="comment">%</span>
0021 <span class="comment">% SEE ALSO: feClipFiberNodes.m, feConnectomePreprocess.m</span>
0022 <span class="comment">%</span>
0023 <span class="comment">%</span>
0024 <span class="comment">% Copyright (2013-2014), Franco Pestilli, Stanford University, pestillifranco@gmail.com.</span>
0025 
0026 fibers    = fg.fibers;
0027 
0028 <span class="comment">% Make sure the coordinates were passed with the expected dimesnions</span>
0029 <span class="keyword">if</span> ~((size(coords,1) == 3) &amp;&amp; (size(coords,2)&gt;=3))
0030   coords = coords';
0031 <span class="keyword">end</span>
0032 
0033 parfor ii = 1:length(fibers)
0034   <span class="comment">% Compute the squared distance between each node on fiber ii and the</span>
0035   <span class="comment">% nearest roi coordinate</span>
0036   [~, nodesSqDistance] = nearpoints(fibers{ii}, coords);
0037   
0038   <span class="comment">% Keep the nodes in the fiber less than the wanted distance</span>
0039   nodesToKeep = (sqrt(nodesSqDistance) &lt;= maxVolDist);
0040   fibers{ii}  = fibers{ii}(:,nodesToKeep);
0041 <span class="keyword">end</span>
0042 fg.fibers     = fibers; clear fibers;
0043 
0044 <span class="comment">% Remove the empty fibers, fibers that had no nodes in the volume</span>
0045 kept = (~cellfun(<span class="string">'isempty'</span>,fg.fibers));
0046 <span class="keyword">if</span> sum(kept) &lt; length(kept)
0047 fg           = fgExtract(fg,kept,<span class="string">'keep'</span>);
0048 <span class="keyword">end</span>
0049 
0050 <span class="keyword">end</span> <span class="comment">% Main function</span></pre></div>
<hr><address>Generated on Wed 16-Jul-2014 19:56:13 by <strong><a href="http://www.artefact.tk/software/matlab/m2html/" title="Matlab Documentation in HTML">m2html</a></strong> &copy; 2005</address>
</body>
</html>